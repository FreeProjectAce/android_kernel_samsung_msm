--- drivers/gpu/msm/kgsl_postmortem.c	2011-04-03 14:17:40.000000000 +0700
+++ drivers/gpu/msm/kgsl_postmortem.c	2011-12-23 19:21:50.000000000 +0700
@@ -421,54 +488,55 @@
 	const char *display;
 };
 
-static int kgsl_dump_fields_line( const char *start, char *str, int slen,
-                                const struct log_field **lines,
-	int num)
+static int kgsl_dump_fields_line(struct kgsl_device *device,
+				 const char *start, char *str, int slen,
+				 const struct log_field **lines,
+				 int num)
 {
-       const struct log_field *l = *lines;
-       int sptr, count  = 0;
-
-       sptr = snprintf(str, slen, "%s", start);
+	const struct log_field *l = *lines;
+	int sptr, count  = 0;
 
-       for (  ; num && sptr < slen; num--, l++) {
-               int ilen = strlen(l->display);
+	sptr = snprintf(str, slen, "%s", start);
 
-               if (count)
-                       ilen += strlen("  | ");
+	for (  ; num && sptr < slen; num--, l++) {
+		int ilen = strlen(l->display);
 
-               if (ilen > (slen - sptr))
-                       break;
+		if (count)
+			ilen += strlen("  | ");
 
-			if (count++)
-                       sptr += snprintf(str + sptr, slen - sptr, " | ");
+		if (ilen > (slen - sptr))
+			break;
 
-               sptr += snprintf(str + sptr, slen - sptr, "%s", l->display);
-			}
+		if (count++)
+			sptr += snprintf(str + sptr, slen - sptr, " | ");
 
-       KGSL_LOG_DUMP("%s\n", str);
+		sptr += snprintf(str + sptr, slen - sptr, "%s", l->display);
+	}
 
-       *lines = l;
-       return num;
+	KGSL_LOG_DUMP(device, "%s\n", str);
 
-		}
+	*lines = l;
+	return num;
+}
 
-static void kgsl_dump_fields(const char *start, const struct log_field *lines,
-	int num)
+static void kgsl_dump_fields(struct kgsl_device *device,
+			     const char *start, const struct log_field *lines,
+			     int num)
 {
 	char lb[90];
 	const char *sstr = start;
 
-      lb[sizeof(lb)  - 1] = '\0';
+	lb[sizeof(lb)  - 1] = '\0';
 
-       while (num) {
-               int ret = kgsl_dump_fields_line(sstr, lb,
-                       sizeof(lb) - 1, &lines, num);
+	while (num) {
+		int ret = kgsl_dump_fields_line(device, sstr, lb,
+			sizeof(lb) - 1, &lines, num);
 
-               if (ret == num)
-                       break;
+		if (ret == num)
+			break;
 
-               num = ret;
-               sstr = "        ";
+		num = ret;
+		sstr = "        ";
 	}
 }
 
